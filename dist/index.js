"use strict";var bn=Object.create;var Bt=Object.defineProperty;var On=Object.getOwnPropertyDescriptor;var Sn=Object.getOwnPropertyNames;var En=Object.getPrototypeOf,xn=Object.prototype.hasOwnProperty;var v=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var In=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Sn(e))!xn.call(t,i)&&i!==r&&Bt(t,i,{get:()=>e[i],enumerable:!(n=On(e,i))||n.enumerable});return t};var J=(t,e,r)=>(r=t!=null?bn(En(t)):{},In(e||!t||!t.__esModule?Bt(r,"default",{value:t,enumerable:!0}):r,t));var Ne=v(le=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.toCommandProperties=le.toCommandValue=void 0;function Rn(t){return t==null?"":typeof t=="string"||t instanceof String?t:JSON.stringify(t)}le.toCommandValue=Rn;function Tn(t){return Object.keys(t).length?{title:t.title,file:t.file,line:t.startLine,endLine:t.endLine,col:t.startColumn,endColumn:t.endColumn}:{}}le.toCommandProperties=Tn});var jt=v(k=>{"use strict";var Nn=k&&k.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Cn=k&&k.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Pn=k&&k.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.hasOwnProperty.call(t,r)&&Nn(e,t,r);return Cn(e,t),e};Object.defineProperty(k,"__esModule",{value:!0});k.issue=k.issueCommand=void 0;var Dn=Pn(require("os")),Ut=Ne();function kt(t,e,r){let n=new nt(t,e,r);process.stdout.write(n.toString()+Dn.EOL)}k.issueCommand=kt;function An(t,e=""){kt(t,{},e)}k.issue=An;var Lt="::",nt=class{constructor(e,r,n){e||(e="missing.command"),this.command=e,this.properties=r,this.message=n}toString(){let e=Lt+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=" ";let r=!0;for(let n in this.properties)if(this.properties.hasOwnProperty(n)){let i=this.properties[n];i&&(r?r=!1:e+=",",e+=`${n}=${Mn(i)}`)}}return e+=`${Lt}${qn(this.message)}`,e}};function qn(t){return Ut.toCommandValue(t).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function Mn(t){return Ut.toCommandValue(t).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}});var ot=v(it=>{"use strict";Object.defineProperty(it,"__esModule",{value:!0});it.default=Ln;var $n=Bn(require("crypto"));function Bn(t){return t&&t.__esModule?t:{default:t}}var Pe=new Uint8Array(256),Ce=Pe.length;function Ln(){return Ce>Pe.length-16&&($n.default.randomFillSync(Pe),Ce=0),Pe.slice(Ce,Ce+=16)}});var Ft=v(De=>{"use strict";Object.defineProperty(De,"__esModule",{value:!0});De.default=void 0;var Un=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;De.default=Un});var be=v(Ae=>{"use strict";Object.defineProperty(Ae,"__esModule",{value:!0});Ae.default=void 0;var kn=jn(Ft());function jn(t){return t&&t.__esModule?t:{default:t}}function Fn(t){return typeof t=="string"&&kn.default.test(t)}var Vn=Fn;Ae.default=Vn});var Oe=v(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.default=void 0;var Jn=zn(be());function zn(t){return t&&t.__esModule?t:{default:t}}var T=[];for(let t=0;t<256;++t)T.push((t+256).toString(16).substr(1));function Gn(t,e=0){let r=(T[t[e+0]]+T[t[e+1]]+T[t[e+2]]+T[t[e+3]]+"-"+T[t[e+4]]+T[t[e+5]]+"-"+T[t[e+6]]+T[t[e+7]]+"-"+T[t[e+8]]+T[t[e+9]]+"-"+T[t[e+10]]+T[t[e+11]]+T[t[e+12]]+T[t[e+13]]+T[t[e+14]]+T[t[e+15]]).toLowerCase();if(!(0,Jn.default)(r))throw TypeError("Stringified UUID is invalid");return r}var Qn=Gn;qe.default=Qn});var zt=v(Me=>{"use strict";Object.defineProperty(Me,"__esModule",{value:!0});Me.default=void 0;var Wn=Jt(ot()),Hn=Jt(Oe());function Jt(t){return t&&t.__esModule?t:{default:t}}var Vt,st,ut=0,at=0;function Kn(t,e,r){let n=e&&r||0,i=e||new Array(16);t=t||{};let o=t.node||Vt,s=t.clockseq!==void 0?t.clockseq:st;if(o==null||s==null){let _=t.random||(t.rng||Wn.default)();o==null&&(o=Vt=[_[0]|1,_[1],_[2],_[3],_[4],_[5]]),s==null&&(s=st=(_[6]<<8|_[7])&16383)}let u=t.msecs!==void 0?t.msecs:Date.now(),c=t.nsecs!==void 0?t.nsecs:at+1,a=u-ut+(c-at)/1e4;if(a<0&&t.clockseq===void 0&&(s=s+1&16383),(a<0||u>ut)&&t.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");ut=u,at=c,st=s,u+=122192928e5;let l=((u&268435455)*1e4+c)%4294967296;i[n++]=l>>>24&255,i[n++]=l>>>16&255,i[n++]=l>>>8&255,i[n++]=l&255;let f=u/4294967296*1e4&268435455;i[n++]=f>>>8&255,i[n++]=f&255,i[n++]=f>>>24&15|16,i[n++]=f>>>16&255,i[n++]=s>>>8|128,i[n++]=s&255;for(let _=0;_<6;++_)i[n+_]=o[_];return e||(0,Hn.default)(i)}var Yn=Kn;Me.default=Yn});var lt=v($e=>{"use strict";Object.defineProperty($e,"__esModule",{value:!0});$e.default=void 0;var Xn=Zn(be());function Zn(t){return t&&t.__esModule?t:{default:t}}function ei(t){if(!(0,Xn.default)(t))throw TypeError("Invalid UUID");let e,r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}var ti=ei;$e.default=ti});var ct=v(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.default=oi;se.URL=se.DNS=void 0;var ri=Gt(Oe()),ni=Gt(lt());function Gt(t){return t&&t.__esModule?t:{default:t}}function ii(t){t=unescape(encodeURIComponent(t));let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}var Qt="6ba7b810-9dad-11d1-80b4-00c04fd430c8";se.DNS=Qt;var Wt="6ba7b811-9dad-11d1-80b4-00c04fd430c8";se.URL=Wt;function oi(t,e,r){function n(i,o,s,u){if(typeof i=="string"&&(i=ii(i)),typeof o=="string"&&(o=(0,ni.default)(o)),o.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+i.length);if(c.set(o),c.set(i,o.length),c=r(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,s){u=u||0;for(let a=0;a<16;++a)s[u+a]=c[a];return s}return(0,ri.default)(c)}try{n.name=t}catch{}return n.DNS=Qt,n.URL=Wt,n}});var Ht=v(Be=>{"use strict";Object.defineProperty(Be,"__esModule",{value:!0});Be.default=void 0;var si=ui(require("crypto"));function ui(t){return t&&t.__esModule?t:{default:t}}function ai(t){return Array.isArray(t)?t=Buffer.from(t):typeof t=="string"&&(t=Buffer.from(t,"utf8")),si.default.createHash("md5").update(t).digest()}var li=ai;Be.default=li});var Yt=v(Le=>{"use strict";Object.defineProperty(Le,"__esModule",{value:!0});Le.default=void 0;var ci=Kt(ct()),fi=Kt(Ht());function Kt(t){return t&&t.__esModule?t:{default:t}}var di=(0,ci.default)("v3",48,fi.default),hi=di;Le.default=hi});var Zt=v(Ue=>{"use strict";Object.defineProperty(Ue,"__esModule",{value:!0});Ue.default=void 0;var _i=Xt(ot()),mi=Xt(Oe());function Xt(t){return t&&t.__esModule?t:{default:t}}function pi(t,e,r){t=t||{};let n=t.random||(t.rng||_i.default)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let i=0;i<16;++i)e[r+i]=n[i];return e}return(0,mi.default)(n)}var gi=pi;Ue.default=gi});var er=v(ke=>{"use strict";Object.defineProperty(ke,"__esModule",{value:!0});ke.default=void 0;var yi=vi(require("crypto"));function vi(t){return t&&t.__esModule?t:{default:t}}function wi(t){return Array.isArray(t)?t=Buffer.from(t):typeof t=="string"&&(t=Buffer.from(t,"utf8")),yi.default.createHash("sha1").update(t).digest()}var bi=wi;ke.default=bi});var rr=v(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.default=void 0;var Oi=tr(ct()),Si=tr(er());function tr(t){return t&&t.__esModule?t:{default:t}}var Ei=(0,Oi.default)("v5",80,Si.default),xi=Ei;je.default=xi});var nr=v(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.default=void 0;var Ii="00000000-0000-0000-0000-000000000000";Fe.default=Ii});var ir=v(Ve=>{"use strict";Object.defineProperty(Ve,"__esModule",{value:!0});Ve.default=void 0;var Ri=Ti(be());function Ti(t){return t&&t.__esModule?t:{default:t}}function Ni(t){if(!(0,Ri.default)(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)}var Ci=Ni;Ve.default=Ci});var or=v(z=>{"use strict";Object.defineProperty(z,"__esModule",{value:!0});Object.defineProperty(z,"v1",{enumerable:!0,get:function(){return Pi.default}});Object.defineProperty(z,"v3",{enumerable:!0,get:function(){return Di.default}});Object.defineProperty(z,"v4",{enumerable:!0,get:function(){return Ai.default}});Object.defineProperty(z,"v5",{enumerable:!0,get:function(){return qi.default}});Object.defineProperty(z,"NIL",{enumerable:!0,get:function(){return Mi.default}});Object.defineProperty(z,"version",{enumerable:!0,get:function(){return $i.default}});Object.defineProperty(z,"validate",{enumerable:!0,get:function(){return Bi.default}});Object.defineProperty(z,"stringify",{enumerable:!0,get:function(){return Li.default}});Object.defineProperty(z,"parse",{enumerable:!0,get:function(){return Ui.default}});var Pi=Y(zt()),Di=Y(Yt()),Ai=Y(Zt()),qi=Y(rr()),Mi=Y(nr()),$i=Y(ir()),Bi=Y(be()),Li=Y(Oe()),Ui=Y(lt());function Y(t){return t&&t.__esModule?t:{default:t}}});var lr=v(j=>{"use strict";var ki=j&&j.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ji=j&&j.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ur=j&&j.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.hasOwnProperty.call(t,r)&&ki(e,t,r);return ji(e,t),e};Object.defineProperty(j,"__esModule",{value:!0});j.prepareKeyValueMessage=j.issueFileCommand=void 0;var sr=ur(require("fs")),ft=ur(require("os")),Fi=or(),ar=Ne();function Vi(t,e){let r=process.env[`GITHUB_${t}`];if(!r)throw new Error(`Unable to find environment variable for file command ${t}`);if(!sr.existsSync(r))throw new Error(`Missing file at path: ${r}`);sr.appendFileSync(r,`${ar.toCommandValue(e)}${ft.EOL}`,{encoding:"utf8"})}j.issueFileCommand=Vi;function Ji(t,e){let r=`ghadelimiter_${Fi.v4()}`,n=ar.toCommandValue(e);if(t.includes(r))throw new Error(`Unexpected input: name should not contain the delimiter "${r}"`);if(n.includes(r))throw new Error(`Unexpected input: value should not contain the delimiter "${r}"`);return`${t}<<${r}${ft.EOL}${n}${ft.EOL}${r}`}j.prepareKeyValueMessage=Ji});var fr=v(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.checkBypass=ce.getProxyUrl=void 0;function zi(t){let e=t.protocol==="https:";if(cr(t))return;let r=(()=>e?process.env.https_proxy||process.env.HTTPS_PROXY:process.env.http_proxy||process.env.HTTP_PROXY)();if(r)return new URL(r)}ce.getProxyUrl=zi;function cr(t){if(!t.hostname)return!1;let e=process.env.no_proxy||process.env.NO_PROXY||"";if(!e)return!1;let r;t.port?r=Number(t.port):t.protocol==="http:"?r=80:t.protocol==="https:"&&(r=443);let n=[t.hostname.toUpperCase()];typeof r=="number"&&n.push(`${n[0]}:${r}`);for(let i of e.split(",").map(o=>o.trim().toUpperCase()).filter(o=>o))if(n.some(o=>o===i))return!0;return!1}ce.checkBypass=cr});var mr=v(fe=>{"use strict";var Ks=require("net"),Gi=require("tls"),dt=require("http"),dr=require("https"),Qi=require("events"),Ys=require("assert"),Wi=require("util");fe.httpOverHttp=Hi;fe.httpsOverHttp=Ki;fe.httpOverHttps=Yi;fe.httpsOverHttps=Xi;function Hi(t){var e=new X(t);return e.request=dt.request,e}function Ki(t){var e=new X(t);return e.request=dt.request,e.createSocket=hr,e.defaultPort=443,e}function Yi(t){var e=new X(t);return e.request=dr.request,e}function Xi(t){var e=new X(t);return e.request=dr.request,e.createSocket=hr,e.defaultPort=443,e}function X(t){var e=this;e.options=t||{},e.proxyOptions=e.options.proxy||{},e.maxSockets=e.options.maxSockets||dt.Agent.defaultMaxSockets,e.requests=[],e.sockets=[],e.on("free",function(n,i,o,s){for(var u=_r(i,o,s),c=0,a=e.requests.length;c<a;++c){var l=e.requests[c];if(l.host===u.host&&l.port===u.port){e.requests.splice(c,1),l.request.onSocket(n);return}}n.destroy(),e.removeSocket(n)})}Wi.inherits(X,Qi.EventEmitter);X.prototype.addRequest=function(e,r,n,i){var o=this,s=ht({request:e},o.options,_r(r,n,i));if(o.sockets.length>=this.maxSockets){o.requests.push(s);return}o.createSocket(s,function(u){u.on("free",c),u.on("close",a),u.on("agentRemove",a),e.onSocket(u);function c(){o.emit("free",u,s)}function a(l){o.removeSocket(u),u.removeListener("free",c),u.removeListener("close",a),u.removeListener("agentRemove",a)}})};X.prototype.createSocket=function(e,r){var n=this,i={};n.sockets.push(i);var o=ht({},n.proxyOptions,{method:"CONNECT",path:e.host+":"+e.port,agent:!1,headers:{host:e.host+":"+e.port}});e.localAddress&&(o.localAddress=e.localAddress),o.proxyAuth&&(o.headers=o.headers||{},o.headers["Proxy-Authorization"]="Basic "+new Buffer(o.proxyAuth).toString("base64")),te("making CONNECT request");var s=n.request(o);s.useChunkedEncodingByDefault=!1,s.once("response",u),s.once("upgrade",c),s.once("connect",a),s.once("error",l),s.end();function u(f){f.upgrade=!0}function c(f,_,N){process.nextTick(function(){a(f,_,N)})}function a(f,_,N){if(s.removeAllListeners(),_.removeAllListeners(),f.statusCode!==200){te("tunneling socket could not be established, statusCode=%d",f.statusCode),_.destroy();var U=new Error("tunneling socket could not be established, statusCode="+f.statusCode);U.code="ECONNRESET",e.request.emit("error",U),n.removeSocket(i);return}if(N.length>0){te("got illegal response body from proxy"),_.destroy();var U=new Error("got illegal response body from proxy");U.code="ECONNRESET",e.request.emit("error",U),n.removeSocket(i);return}return te("tunneling connection has established"),n.sockets[n.sockets.indexOf(i)]=_,r(_)}function l(f){s.removeAllListeners(),te(`tunneling socket could not be established, cause=%s
`,f.message,f.stack);var _=new Error("tunneling socket could not be established, cause="+f.message);_.code="ECONNRESET",e.request.emit("error",_),n.removeSocket(i)}};X.prototype.removeSocket=function(e){var r=this.sockets.indexOf(e);if(r!==-1){this.sockets.splice(r,1);var n=this.requests.shift();n&&this.createSocket(n,function(i){n.request.onSocket(i)})}};function hr(t,e){var r=this;X.prototype.createSocket.call(r,t,function(n){var i=t.request.getHeader("host"),o=ht({},r.options,{socket:n,servername:i?i.replace(/:.*$/,""):t.host}),s=Gi.connect(0,o);r.sockets[r.sockets.indexOf(n)]=s,e(s)})}function _r(t,e,r){return typeof t=="string"?{host:t,port:e,localAddress:r}:t}function ht(t){for(var e=1,r=arguments.length;e<r;++e){var n=arguments[e];if(typeof n=="object")for(var i=Object.keys(n),o=0,s=i.length;o<s;++o){var u=i[o];n[u]!==void 0&&(t[u]=n[u])}}return t}var te;process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)?te=function(){var t=Array.prototype.slice.call(arguments);typeof t[0]=="string"?t[0]="TUNNEL: "+t[0]:t.unshift("TUNNEL:"),console.error.apply(console,t)}:te=function(){};fe.debug=te});var gr=v((Zs,pr)=>{pr.exports=mr()});var pt=v(b=>{"use strict";var Zi=b&&b.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),eo=b&&b.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),We=b&&b.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.hasOwnProperty.call(t,r)&&Zi(e,t,r);return eo(e,t),e},R=b&&b.__awaiter||function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(l){try{a(n.next(l))}catch(f){s(f)}}function c(l){try{a(n.throw(l))}catch(f){s(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,c)}a((n=n.apply(t,e||[])).next())})};Object.defineProperty(b,"__esModule",{value:!0});b.HttpClient=b.isHttps=b.HttpClientResponse=b.HttpClientError=b.getProxyUrl=b.MediaTypes=b.Headers=b.HttpCodes=void 0;var Je=We(require("http")),_t=We(require("https")),yr=We(fr()),ze=We(gr()),G;(function(t){t[t.OK=200]="OK",t[t.MultipleChoices=300]="MultipleChoices",t[t.MovedPermanently=301]="MovedPermanently",t[t.ResourceMoved=302]="ResourceMoved",t[t.SeeOther=303]="SeeOther",t[t.NotModified=304]="NotModified",t[t.UseProxy=305]="UseProxy",t[t.SwitchProxy=306]="SwitchProxy",t[t.TemporaryRedirect=307]="TemporaryRedirect",t[t.PermanentRedirect=308]="PermanentRedirect",t[t.BadRequest=400]="BadRequest",t[t.Unauthorized=401]="Unauthorized",t[t.PaymentRequired=402]="PaymentRequired",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.NotAcceptable=406]="NotAcceptable",t[t.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",t[t.RequestTimeout=408]="RequestTimeout",t[t.Conflict=409]="Conflict",t[t.Gone=410]="Gone",t[t.TooManyRequests=429]="TooManyRequests",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout"})(G=b.HttpCodes||(b.HttpCodes={}));var D;(function(t){t.Accept="accept",t.ContentType="content-type"})(D=b.Headers||(b.Headers={}));var re;(function(t){t.ApplicationJson="application/json"})(re=b.MediaTypes||(b.MediaTypes={}));function to(t){let e=yr.getProxyUrl(new URL(t));return e?e.href:""}b.getProxyUrl=to;var ro=[G.MovedPermanently,G.ResourceMoved,G.SeeOther,G.TemporaryRedirect,G.PermanentRedirect],no=[G.BadGateway,G.ServiceUnavailable,G.GatewayTimeout],io=["OPTIONS","GET","DELETE","HEAD"],oo=10,so=5,de=class extends Error{constructor(e,r){super(e),this.name="HttpClientError",this.statusCode=r,Object.setPrototypeOf(this,de.prototype)}};b.HttpClientError=de;var Qe=class{constructor(e){this.message=e}readBody(){return R(this,void 0,void 0,function*(){return new Promise(e=>R(this,void 0,void 0,function*(){let r=Buffer.alloc(0);this.message.on("data",n=>{r=Buffer.concat([r,n])}),this.message.on("end",()=>{e(r.toString())})}))})}};b.HttpClientResponse=Qe;function uo(t){return new URL(t).protocol==="https:"}b.isHttps=uo;var mt=class{constructor(e,r,n){this._ignoreSslError=!1,this._allowRedirects=!0,this._allowRedirectDowngrade=!1,this._maxRedirects=50,this._allowRetries=!1,this._maxRetries=1,this._keepAlive=!1,this._disposed=!1,this.userAgent=e,this.handlers=r||[],this.requestOptions=n,n&&(n.ignoreSslError!=null&&(this._ignoreSslError=n.ignoreSslError),this._socketTimeout=n.socketTimeout,n.allowRedirects!=null&&(this._allowRedirects=n.allowRedirects),n.allowRedirectDowngrade!=null&&(this._allowRedirectDowngrade=n.allowRedirectDowngrade),n.maxRedirects!=null&&(this._maxRedirects=Math.max(n.maxRedirects,0)),n.keepAlive!=null&&(this._keepAlive=n.keepAlive),n.allowRetries!=null&&(this._allowRetries=n.allowRetries),n.maxRetries!=null&&(this._maxRetries=n.maxRetries))}options(e,r){return R(this,void 0,void 0,function*(){return this.request("OPTIONS",e,null,r||{})})}get(e,r){return R(this,void 0,void 0,function*(){return this.request("GET",e,null,r||{})})}del(e,r){return R(this,void 0,void 0,function*(){return this.request("DELETE",e,null,r||{})})}post(e,r,n){return R(this,void 0,void 0,function*(){return this.request("POST",e,r,n||{})})}patch(e,r,n){return R(this,void 0,void 0,function*(){return this.request("PATCH",e,r,n||{})})}put(e,r,n){return R(this,void 0,void 0,function*(){return this.request("PUT",e,r,n||{})})}head(e,r){return R(this,void 0,void 0,function*(){return this.request("HEAD",e,null,r||{})})}sendStream(e,r,n,i){return R(this,void 0,void 0,function*(){return this.request(e,r,n,i)})}getJson(e,r={}){return R(this,void 0,void 0,function*(){r[D.Accept]=this._getExistingOrDefaultHeader(r,D.Accept,re.ApplicationJson);let n=yield this.get(e,r);return this._processResponse(n,this.requestOptions)})}postJson(e,r,n={}){return R(this,void 0,void 0,function*(){let i=JSON.stringify(r,null,2);n[D.Accept]=this._getExistingOrDefaultHeader(n,D.Accept,re.ApplicationJson),n[D.ContentType]=this._getExistingOrDefaultHeader(n,D.ContentType,re.ApplicationJson);let o=yield this.post(e,i,n);return this._processResponse(o,this.requestOptions)})}putJson(e,r,n={}){return R(this,void 0,void 0,function*(){let i=JSON.stringify(r,null,2);n[D.Accept]=this._getExistingOrDefaultHeader(n,D.Accept,re.ApplicationJson),n[D.ContentType]=this._getExistingOrDefaultHeader(n,D.ContentType,re.ApplicationJson);let o=yield this.put(e,i,n);return this._processResponse(o,this.requestOptions)})}patchJson(e,r,n={}){return R(this,void 0,void 0,function*(){let i=JSON.stringify(r,null,2);n[D.Accept]=this._getExistingOrDefaultHeader(n,D.Accept,re.ApplicationJson),n[D.ContentType]=this._getExistingOrDefaultHeader(n,D.ContentType,re.ApplicationJson);let o=yield this.patch(e,i,n);return this._processResponse(o,this.requestOptions)})}request(e,r,n,i){return R(this,void 0,void 0,function*(){if(this._disposed)throw new Error("Client has already been disposed.");let o=new URL(r),s=this._prepareRequest(e,o,i),u=this._allowRetries&&io.includes(e)?this._maxRetries+1:1,c=0,a;do{if(a=yield this.requestRaw(s,n),a&&a.message&&a.message.statusCode===G.Unauthorized){let f;for(let _ of this.handlers)if(_.canHandleAuthentication(a)){f=_;break}return f?f.handleAuthentication(this,s,n):a}let l=this._maxRedirects;for(;a.message.statusCode&&ro.includes(a.message.statusCode)&&this._allowRedirects&&l>0;){let f=a.message.headers.location;if(!f)break;let _=new URL(f);if(o.protocol==="https:"&&o.protocol!==_.protocol&&!this._allowRedirectDowngrade)throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.");if(yield a.readBody(),_.hostname!==o.hostname)for(let N in i)N.toLowerCase()==="authorization"&&delete i[N];s=this._prepareRequest(e,_,i),a=yield this.requestRaw(s,n),l--}if(!a.message.statusCode||!no.includes(a.message.statusCode))return a;c+=1,c<u&&(yield a.readBody(),yield this._performExponentialBackoff(c))}while(c<u);return a})}dispose(){this._agent&&this._agent.destroy(),this._disposed=!0}requestRaw(e,r){return R(this,void 0,void 0,function*(){return new Promise((n,i)=>{function o(s,u){s?i(s):u?n(u):i(new Error("Unknown error"))}this.requestRawWithCallback(e,r,o)})})}requestRawWithCallback(e,r,n){typeof r=="string"&&(e.options.headers||(e.options.headers={}),e.options.headers["Content-Length"]=Buffer.byteLength(r,"utf8"));let i=!1;function o(c,a){i||(i=!0,n(c,a))}let s=e.httpModule.request(e.options,c=>{let a=new Qe(c);o(void 0,a)}),u;s.on("socket",c=>{u=c}),s.setTimeout(this._socketTimeout||3*6e4,()=>{u&&u.end(),o(new Error(`Request timeout: ${e.options.path}`))}),s.on("error",function(c){o(c)}),r&&typeof r=="string"&&s.write(r,"utf8"),r&&typeof r!="string"?(r.on("close",function(){s.end()}),r.pipe(s)):s.end()}getAgent(e){let r=new URL(e);return this._getAgent(r)}_prepareRequest(e,r,n){let i={};i.parsedUrl=r;let o=i.parsedUrl.protocol==="https:";i.httpModule=o?_t:Je;let s=o?443:80;if(i.options={},i.options.host=i.parsedUrl.hostname,i.options.port=i.parsedUrl.port?parseInt(i.parsedUrl.port):s,i.options.path=(i.parsedUrl.pathname||"")+(i.parsedUrl.search||""),i.options.method=e,i.options.headers=this._mergeHeaders(n),this.userAgent!=null&&(i.options.headers["user-agent"]=this.userAgent),i.options.agent=this._getAgent(i.parsedUrl),this.handlers)for(let u of this.handlers)u.prepareRequest(i.options);return i}_mergeHeaders(e){return this.requestOptions&&this.requestOptions.headers?Object.assign({},Ge(this.requestOptions.headers),Ge(e||{})):Ge(e||{})}_getExistingOrDefaultHeader(e,r,n){let i;return this.requestOptions&&this.requestOptions.headers&&(i=Ge(this.requestOptions.headers)[r]),e[r]||i||n}_getAgent(e){let r,n=yr.getProxyUrl(e),i=n&&n.hostname;if(this._keepAlive&&i&&(r=this._proxyAgent),this._keepAlive&&!i&&(r=this._agent),r)return r;let o=e.protocol==="https:",s=100;if(this.requestOptions&&(s=this.requestOptions.maxSockets||Je.globalAgent.maxSockets),n&&n.hostname){let u={maxSockets:s,keepAlive:this._keepAlive,proxy:Object.assign(Object.assign({},(n.username||n.password)&&{proxyAuth:`${n.username}:${n.password}`}),{host:n.hostname,port:n.port})},c,a=n.protocol==="https:";o?c=a?ze.httpsOverHttps:ze.httpsOverHttp:c=a?ze.httpOverHttps:ze.httpOverHttp,r=c(u),this._proxyAgent=r}if(this._keepAlive&&!r){let u={keepAlive:this._keepAlive,maxSockets:s};r=o?new _t.Agent(u):new Je.Agent(u),this._agent=r}return r||(r=o?_t.globalAgent:Je.globalAgent),o&&this._ignoreSslError&&(r.options=Object.assign(r.options||{},{rejectUnauthorized:!1})),r}_performExponentialBackoff(e){return R(this,void 0,void 0,function*(){e=Math.min(oo,e);let r=so*Math.pow(2,e);return new Promise(n=>setTimeout(()=>n(),r))})}_processResponse(e,r){return R(this,void 0,void 0,function*(){return new Promise((n,i)=>R(this,void 0,void 0,function*(){let o=e.message.statusCode||0,s={statusCode:o,result:null,headers:{}};o===G.NotFound&&n(s);function u(l,f){if(typeof f=="string"){let _=new Date(f);if(!isNaN(_.valueOf()))return _}return f}let c,a;try{a=yield e.readBody(),a&&a.length>0&&(r&&r.deserializeDates?c=JSON.parse(a,u):c=JSON.parse(a),s.result=c),s.headers=e.message.headers}catch{}if(o>299){let l;c&&c.message?l=c.message:a&&a.length>0?l=a:l=`Failed request: (${o})`;let f=new de(l,o);f.result=s.result,i(f)}else n(s)}))})}};b.HttpClient=mt;var Ge=t=>Object.keys(t).reduce((e,r)=>(e[r.toLowerCase()]=t[r],e),{})});var vr=v(Q=>{"use strict";var wt=Q&&Q.__awaiter||function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(l){try{a(n.next(l))}catch(f){s(f)}}function c(l){try{a(n.throw(l))}catch(f){s(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,c)}a((n=n.apply(t,e||[])).next())})};Object.defineProperty(Q,"__esModule",{value:!0});Q.PersonalAccessTokenCredentialHandler=Q.BearerCredentialHandler=Q.BasicCredentialHandler=void 0;var gt=class{constructor(e,r){this.username=e,this.password=r}prepareRequest(e){if(!e.headers)throw Error("The request has no headers");e.headers.Authorization=`Basic ${Buffer.from(`${this.username}:${this.password}`).toString("base64")}`}canHandleAuthentication(){return!1}handleAuthentication(){return wt(this,void 0,void 0,function*(){throw new Error("not implemented")})}};Q.BasicCredentialHandler=gt;var yt=class{constructor(e){this.token=e}prepareRequest(e){if(!e.headers)throw Error("The request has no headers");e.headers.Authorization=`Bearer ${this.token}`}canHandleAuthentication(){return!1}handleAuthentication(){return wt(this,void 0,void 0,function*(){throw new Error("not implemented")})}};Q.BearerCredentialHandler=yt;var vt=class{constructor(e){this.token=e}prepareRequest(e){if(!e.headers)throw Error("The request has no headers");e.headers.Authorization=`Basic ${Buffer.from(`PAT:${this.token}`).toString("base64")}`}canHandleAuthentication(){return!1}handleAuthentication(){return wt(this,void 0,void 0,function*(){throw new Error("not implemented")})}};Q.PersonalAccessTokenCredentialHandler=vt});var Or=v(he=>{"use strict";var wr=he&&he.__awaiter||function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(l){try{a(n.next(l))}catch(f){s(f)}}function c(l){try{a(n.throw(l))}catch(f){s(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,c)}a((n=n.apply(t,e||[])).next())})};Object.defineProperty(he,"__esModule",{value:!0});he.OidcClient=void 0;var ao=pt(),lo=vr(),br=Se(),ne=class{static createHttpClient(e=!0,r=10){let n={allowRetries:e,maxRetries:r};return new ao.HttpClient("actions/oidc-client",[new lo.BearerCredentialHandler(ne.getRequestToken())],n)}static getRequestToken(){let e=process.env.ACTIONS_ID_TOKEN_REQUEST_TOKEN;if(!e)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable");return e}static getIDTokenUrl(){let e=process.env.ACTIONS_ID_TOKEN_REQUEST_URL;if(!e)throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable");return e}static getCall(e){var r;return wr(this,void 0,void 0,function*(){let o=(r=(yield ne.createHttpClient().getJson(e).catch(s=>{throw new Error(`Failed to get ID Token. 
 
        Error Code : ${s.statusCode}
 
        Error Message: ${s.result.message}`)})).result)===null||r===void 0?void 0:r.value;if(!o)throw new Error("Response json body do not have ID Token field");return o})}static getIDToken(e){return wr(this,void 0,void 0,function*(){try{let r=ne.getIDTokenUrl();if(e){let i=encodeURIComponent(e);r=`${r}&audience=${i}`}br.debug(`ID token url is ${r}`);let n=yield ne.getCall(r);return br.setSecret(n),n}catch(r){throw new Error(`Error message: ${r.message}`)}})}};he.OidcClient=ne});var Et=v(M=>{"use strict";var bt=M&&M.__awaiter||function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(l){try{a(n.next(l))}catch(f){s(f)}}function c(l){try{a(n.throw(l))}catch(f){s(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,c)}a((n=n.apply(t,e||[])).next())})};Object.defineProperty(M,"__esModule",{value:!0});M.summary=M.markdownSummary=M.SUMMARY_DOCS_URL=M.SUMMARY_ENV_VAR=void 0;var co=require("os"),Ot=require("fs"),{access:fo,appendFile:ho,writeFile:_o}=Ot.promises;M.SUMMARY_ENV_VAR="GITHUB_STEP_SUMMARY";M.SUMMARY_DOCS_URL="https://docs.github.com/actions/using-workflows/workflow-commands-for-github-actions#adding-a-job-summary";var St=class{constructor(){this._buffer=""}filePath(){return bt(this,void 0,void 0,function*(){if(this._filePath)return this._filePath;let e=process.env[M.SUMMARY_ENV_VAR];if(!e)throw new Error(`Unable to find environment variable for $${M.SUMMARY_ENV_VAR}. Check if your runtime environment supports job summaries.`);try{yield fo(e,Ot.constants.R_OK|Ot.constants.W_OK)}catch{throw new Error(`Unable to access summary file: '${e}'. Check if the file has correct read/write permissions.`)}return this._filePath=e,this._filePath})}wrap(e,r,n={}){let i=Object.entries(n).map(([o,s])=>` ${o}="${s}"`).join("");return r?`<${e}${i}>${r}</${e}>`:`<${e}${i}>`}write(e){return bt(this,void 0,void 0,function*(){let r=!!(e!=null&&e.overwrite),n=yield this.filePath();return yield(r?_o:ho)(n,this._buffer,{encoding:"utf8"}),this.emptyBuffer()})}clear(){return bt(this,void 0,void 0,function*(){return this.emptyBuffer().write({overwrite:!0})})}stringify(){return this._buffer}isEmptyBuffer(){return this._buffer.length===0}emptyBuffer(){return this._buffer="",this}addRaw(e,r=!1){return this._buffer+=e,r?this.addEOL():this}addEOL(){return this.addRaw(co.EOL)}addCodeBlock(e,r){let n=Object.assign({},r&&{lang:r}),i=this.wrap("pre",this.wrap("code",e),n);return this.addRaw(i).addEOL()}addList(e,r=!1){let n=r?"ol":"ul",i=e.map(s=>this.wrap("li",s)).join(""),o=this.wrap(n,i);return this.addRaw(o).addEOL()}addTable(e){let r=e.map(i=>{let o=i.map(s=>{if(typeof s=="string")return this.wrap("td",s);let{header:u,data:c,colspan:a,rowspan:l}=s,f=u?"th":"td",_=Object.assign(Object.assign({},a&&{colspan:a}),l&&{rowspan:l});return this.wrap(f,c,_)}).join("");return this.wrap("tr",o)}).join(""),n=this.wrap("table",r);return this.addRaw(n).addEOL()}addDetails(e,r){let n=this.wrap("details",this.wrap("summary",e)+r);return this.addRaw(n).addEOL()}addImage(e,r,n){let{width:i,height:o}=n||{},s=Object.assign(Object.assign({},i&&{width:i}),o&&{height:o}),u=this.wrap("img",null,Object.assign({src:e,alt:r},s));return this.addRaw(u).addEOL()}addHeading(e,r){let n=`h${r}`,i=["h1","h2","h3","h4","h5","h6"].includes(n)?n:"h1",o=this.wrap(i,e);return this.addRaw(o).addEOL()}addSeparator(){let e=this.wrap("hr",null);return this.addRaw(e).addEOL()}addBreak(){let e=this.wrap("br",null);return this.addRaw(e).addEOL()}addQuote(e,r){let n=Object.assign({},r&&{cite:r}),i=this.wrap("blockquote",e,n);return this.addRaw(i).addEOL()}addLink(e,r){let n=this.wrap("a",e,{href:r});return this.addRaw(n).addEOL()}},Sr=new St;M.markdownSummary=Sr;M.summary=Sr});var Er=v($=>{"use strict";var mo=$&&$.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),po=$&&$.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),go=$&&$.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.hasOwnProperty.call(t,r)&&mo(e,t,r);return po(e,t),e};Object.defineProperty($,"__esModule",{value:!0});$.toPlatformPath=$.toWin32Path=$.toPosixPath=void 0;var yo=go(require("path"));function vo(t){return t.replace(/[\\]/g,"/")}$.toPosixPath=vo;function wo(t){return t.replace(/[/]/g,"\\")}$.toWin32Path=wo;function bo(t){return t.replace(/[/\\]/g,yo.sep)}$.toPlatformPath=bo});var Se=v(d=>{"use strict";var Oo=d&&d.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),So=d&&d.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),xr=d&&d.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.hasOwnProperty.call(t,r)&&Oo(e,t,r);return So(e,t),e},Ir=d&&d.__awaiter||function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(l){try{a(n.next(l))}catch(f){s(f)}}function c(l){try{a(n.throw(l))}catch(f){s(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,c)}a((n=n.apply(t,e||[])).next())})};Object.defineProperty(d,"__esModule",{value:!0});d.getIDToken=d.getState=d.saveState=d.group=d.endGroup=d.startGroup=d.info=d.notice=d.warning=d.error=d.debug=d.isDebug=d.setFailed=d.setCommandEcho=d.setOutput=d.getBooleanInput=d.getMultilineInput=d.getInput=d.addPath=d.setSecret=d.exportVariable=d.ExitCode=void 0;var F=jt(),ue=lr(),_e=Ne(),Rr=xr(require("os")),Eo=xr(require("path")),xo=Or(),Tr;(function(t){t[t.Success=0]="Success",t[t.Failure=1]="Failure"})(Tr=d.ExitCode||(d.ExitCode={}));function Io(t,e){let r=_e.toCommandValue(e);if(process.env[t]=r,process.env.GITHUB_ENV||"")return ue.issueFileCommand("ENV",ue.prepareKeyValueMessage(t,e));F.issueCommand("set-env",{name:t},r)}d.exportVariable=Io;function Ro(t){F.issueCommand("add-mask",{},t)}d.setSecret=Ro;function To(t){process.env.GITHUB_PATH||""?ue.issueFileCommand("PATH",t):F.issueCommand("add-path",{},t),process.env.PATH=`${t}${Eo.delimiter}${process.env.PATH}`}d.addPath=To;function xt(t,e){let r=process.env[`INPUT_${t.replace(/ /g,"_").toUpperCase()}`]||"";if(e&&e.required&&!r)throw new Error(`Input required and not supplied: ${t}`);return e&&e.trimWhitespace===!1?r:r.trim()}d.getInput=xt;function No(t,e){let r=xt(t,e).split(`
`).filter(n=>n!=="");return e&&e.trimWhitespace===!1?r:r.map(n=>n.trim())}d.getMultilineInput=No;function Co(t,e){let r=["true","True","TRUE"],n=["false","False","FALSE"],i=xt(t,e);if(r.includes(i))return!0;if(n.includes(i))return!1;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${t}
Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}d.getBooleanInput=Co;function Po(t,e){if(process.env.GITHUB_OUTPUT||"")return ue.issueFileCommand("OUTPUT",ue.prepareKeyValueMessage(t,e));process.stdout.write(Rr.EOL),F.issueCommand("set-output",{name:t},_e.toCommandValue(e))}d.setOutput=Po;function Do(t){F.issue("echo",t?"on":"off")}d.setCommandEcho=Do;function Ao(t){process.exitCode=Tr.Failure,Nr(t)}d.setFailed=Ao;function qo(){return process.env.RUNNER_DEBUG==="1"}d.isDebug=qo;function Mo(t){F.issueCommand("debug",{},t)}d.debug=Mo;function Nr(t,e={}){F.issueCommand("error",_e.toCommandProperties(e),t instanceof Error?t.toString():t)}d.error=Nr;function $o(t,e={}){F.issueCommand("warning",_e.toCommandProperties(e),t instanceof Error?t.toString():t)}d.warning=$o;function Bo(t,e={}){F.issueCommand("notice",_e.toCommandProperties(e),t instanceof Error?t.toString():t)}d.notice=Bo;function Lo(t){process.stdout.write(t+Rr.EOL)}d.info=Lo;function Cr(t){F.issue("group",t)}d.startGroup=Cr;function Pr(){F.issue("endgroup")}d.endGroup=Pr;function Uo(t,e){return Ir(this,void 0,void 0,function*(){Cr(t);let r;try{r=yield e()}finally{Pr()}return r})}d.group=Uo;function ko(t,e){if(process.env.GITHUB_STATE||"")return ue.issueFileCommand("STATE",ue.prepareKeyValueMessage(t,e));F.issueCommand("save-state",{name:t},_e.toCommandValue(e))}d.saveState=ko;function jo(t){return process.env[`STATE_${t}`]||""}d.getState=jo;function Fo(t){return Ir(this,void 0,void 0,function*(){return yield xo.OidcClient.getIDToken(t)})}d.getIDToken=Fo;var Vo=Et();Object.defineProperty(d,"summary",{enumerable:!0,get:function(){return Vo.summary}});var Jo=Et();Object.defineProperty(d,"markdownSummary",{enumerable:!0,get:function(){return Jo.markdownSummary}});var It=Er();Object.defineProperty(d,"toPosixPath",{enumerable:!0,get:function(){return It.toPosixPath}});Object.defineProperty(d,"toWin32Path",{enumerable:!0,get:function(){return It.toWin32Path}});Object.defineProperty(d,"toPlatformPath",{enumerable:!0,get:function(){return It.toPlatformPath}})});var At=v(h=>{"use strict";var Zo=h&&h.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),es=h&&h.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Vr=h&&h.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.hasOwnProperty.call(t,r)&&Zo(e,t,r);return es(e,t),e},Dt=h&&h.__awaiter||function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(l){try{a(n.next(l))}catch(f){s(f)}}function c(l){try{a(n.throw(l))}catch(f){s(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,c)}a((n=n.apply(t,e||[])).next())})},V;Object.defineProperty(h,"__esModule",{value:!0});h.getCmdPath=h.tryGetExecutablePath=h.isRooted=h.isDirectory=h.exists=h.IS_WINDOWS=h.unlink=h.symlink=h.stat=h.rmdir=h.rename=h.readlink=h.readdir=h.mkdir=h.lstat=h.copyFile=h.chmod=void 0;var ts=Vr(require("fs")),Ye=Vr(require("path"));V=ts.promises,h.chmod=V.chmod,h.copyFile=V.copyFile,h.lstat=V.lstat,h.mkdir=V.mkdir,h.readdir=V.readdir,h.readlink=V.readlink,h.rename=V.rename,h.rmdir=V.rmdir,h.stat=V.stat,h.symlink=V.symlink,h.unlink=V.unlink;h.IS_WINDOWS=process.platform==="win32";function rs(t){return Dt(this,void 0,void 0,function*(){try{yield h.stat(t)}catch(e){if(e.code==="ENOENT")return!1;throw e}return!0})}h.exists=rs;function ns(t,e=!1){return Dt(this,void 0,void 0,function*(){return(e?yield h.stat(t):yield h.lstat(t)).isDirectory()})}h.isDirectory=ns;function is(t){if(t=ss(t),!t)throw new Error('isRooted() parameter "p" cannot be empty');return h.IS_WINDOWS?t.startsWith("\\")||/^[A-Z]:/i.test(t):t.startsWith("/")}h.isRooted=is;function os(t,e){return Dt(this,void 0,void 0,function*(){let r;try{r=yield h.stat(t)}catch(i){i.code!=="ENOENT"&&console.log(`Unexpected error attempting to determine if executable file exists '${t}': ${i}`)}if(r&&r.isFile()){if(h.IS_WINDOWS){let i=Ye.extname(t).toUpperCase();if(e.some(o=>o.toUpperCase()===i))return t}else if(Fr(r))return t}let n=t;for(let i of e){t=n+i,r=void 0;try{r=yield h.stat(t)}catch(o){o.code!=="ENOENT"&&console.log(`Unexpected error attempting to determine if executable file exists '${t}': ${o}`)}if(r&&r.isFile()){if(h.IS_WINDOWS){try{let o=Ye.dirname(t),s=Ye.basename(t).toUpperCase();for(let u of yield h.readdir(o))if(s===u.toUpperCase()){t=Ye.join(o,u);break}}catch(o){console.log(`Unexpected error attempting to determine the actual case of the file '${t}': ${o}`)}return t}else if(Fr(r))return t}}return""})}h.tryGetExecutablePath=os;function ss(t){return t=t||"",h.IS_WINDOWS?(t=t.replace(/\//g,"\\"),t.replace(/\\\\+/g,"\\")):t.replace(/\/\/+/g,"/")}function Fr(t){return(t.mode&1)>0||(t.mode&8)>0&&t.gid===process.getgid()||(t.mode&64)>0&&t.uid===process.getuid()}function us(){var t;return(t=process.env.COMSPEC)!==null&&t!==void 0?t:"cmd.exe"}h.getCmdPath=us});var Xr=v(E=>{"use strict";var as=E&&E.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ls=E&&E.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),qt=E&&E.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.hasOwnProperty.call(t,r)&&as(e,t,r);return ls(e,t),e},ie=E&&E.__awaiter||function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(l){try{a(n.next(l))}catch(f){s(f)}}function c(l){try{a(n.throw(l))}catch(f){s(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,c)}a((n=n.apply(t,e||[])).next())})};Object.defineProperty(E,"__esModule",{value:!0});E.findInPath=E.which=E.mkdirP=E.rmRF=E.mv=E.cp=void 0;var cs=require("assert"),zr=qt(require("child_process")),W=qt(require("path")),Gr=require("util"),g=qt(At()),Jr=Gr.promisify(zr.exec),fs=Gr.promisify(zr.execFile);function ds(t,e,r={}){return ie(this,void 0,void 0,function*(){let{force:n,recursive:i,copySourceDirectory:o}=_s(r),s=(yield g.exists(e))?yield g.stat(e):null;if(s&&s.isFile()&&!n)return;let u=s&&s.isDirectory()&&o?W.join(e,W.basename(t)):e;if(!(yield g.exists(t)))throw new Error(`no such file or directory: ${t}`);if((yield g.stat(t)).isDirectory())if(i)yield Kr(t,u,0,n);else throw new Error(`Failed to copy. ${t} is a directory, but tried to copy without recursive flag.`);else{if(W.relative(t,u)==="")throw new Error(`'${u}' and '${t}' are the same file`);yield Yr(t,u,n)}})}E.cp=ds;function hs(t,e,r={}){return ie(this,void 0,void 0,function*(){if(yield g.exists(e)){let n=!0;if((yield g.isDirectory(e))&&(e=W.join(e,W.basename(t)),n=yield g.exists(e)),n)if(r.force==null||r.force)yield Qr(e);else throw new Error("Destination already exists")}yield Mt(W.dirname(e)),yield g.rename(t,e)})}E.mv=hs;function Qr(t){return ie(this,void 0,void 0,function*(){if(g.IS_WINDOWS){if(/[*"<>|]/.test(t))throw new Error('File path must not contain `*`, `"`, `<`, `>` or `|` on Windows');try{let e=g.getCmdPath();(yield g.isDirectory(t,!0))?yield Jr(`${e} /s /c "rd /s /q "%inputPath%""`,{env:{inputPath:t}}):yield Jr(`${e} /s /c "del /f /a "%inputPath%""`,{env:{inputPath:t}})}catch(e){if(e.code!=="ENOENT")throw e}try{yield g.unlink(t)}catch(e){if(e.code!=="ENOENT")throw e}}else{let e=!1;try{e=yield g.isDirectory(t)}catch(r){if(r.code!=="ENOENT")throw r;return}e?yield fs("rm",["-rf",`${t}`]):yield g.unlink(t)}})}E.rmRF=Qr;function Mt(t){return ie(this,void 0,void 0,function*(){cs.ok(t,"a path argument must be provided"),yield g.mkdir(t,{recursive:!0})})}E.mkdirP=Mt;function Wr(t,e){return ie(this,void 0,void 0,function*(){if(!t)throw new Error("parameter 'tool' is required");if(e){let n=yield Wr(t,!1);if(!n)throw g.IS_WINDOWS?new Error(`Unable to locate executable file: ${t}. Please verify either the file path exists or the file can be found within a directory specified by the PATH environment variable. Also verify the file has a valid extension for an executable file.`):new Error(`Unable to locate executable file: ${t}. Please verify either the file path exists or the file can be found within a directory specified by the PATH environment variable. Also check the file mode to verify the file is executable.`);return n}let r=yield Hr(t);return r&&r.length>0?r[0]:""})}E.which=Wr;function Hr(t){return ie(this,void 0,void 0,function*(){if(!t)throw new Error("parameter 'tool' is required");let e=[];if(g.IS_WINDOWS&&process.env.PATHEXT)for(let i of process.env.PATHEXT.split(W.delimiter))i&&e.push(i);if(g.isRooted(t)){let i=yield g.tryGetExecutablePath(t,e);return i?[i]:[]}if(t.includes(W.sep))return[];let r=[];if(process.env.PATH)for(let i of process.env.PATH.split(W.delimiter))i&&r.push(i);let n=[];for(let i of r){let o=yield g.tryGetExecutablePath(W.join(i,t),e);o&&n.push(o)}return n})}E.findInPath=Hr;function _s(t){let e=t.force==null?!0:t.force,r=Boolean(t.recursive),n=t.copySourceDirectory==null?!0:Boolean(t.copySourceDirectory);return{force:e,recursive:r,copySourceDirectory:n}}function Kr(t,e,r,n){return ie(this,void 0,void 0,function*(){if(r>=255)return;r++,yield Mt(e);let i=yield g.readdir(t);for(let o of i){let s=`${t}/${o}`,u=`${e}/${o}`;(yield g.lstat(s)).isDirectory()?yield Kr(s,u,r,n):yield Yr(s,u,n)}yield g.chmod(e,(yield g.stat(t)).mode)})}function Yr(t,e,r){return ie(this,void 0,void 0,function*(){if((yield g.lstat(t)).isSymbolicLink()){try{yield g.lstat(e),yield g.unlink(e)}catch(i){i.code==="EPERM"&&(yield g.chmod(e,"0666"),yield g.unlink(e))}let n=yield g.readlink(t);yield g.symlink(n,e,g.IS_WINDOWS?"junction":null)}else(!(yield g.exists(e))||r)&&(yield g.copyFile(t,e))})}});var rn=v(B=>{"use strict";var ms=B&&B.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ps=B&&B.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ge=B&&B.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.hasOwnProperty.call(t,r)&&ms(e,t,r);return ps(e,t),e},Zr=B&&B.__awaiter||function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(l){try{a(n.next(l))}catch(f){s(f)}}function c(l){try{a(n.throw(l))}catch(f){s(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,c)}a((n=n.apply(t,e||[])).next())})};Object.defineProperty(B,"__esModule",{value:!0});B.argStringToArray=B.ToolRunner=void 0;var Xe=ge(require("os")),tn=ge(require("events")),gs=ge(require("child_process")),ys=ge(require("path")),vs=ge(Xr()),en=ge(At()),ws=require("timers"),Ze=process.platform==="win32",$t=class extends tn.EventEmitter{constructor(e,r,n){if(super(),!e)throw new Error("Parameter 'toolPath' cannot be null or empty.");this.toolPath=e,this.args=r||[],this.options=n||{}}_debug(e){this.options.listeners&&this.options.listeners.debug&&this.options.listeners.debug(e)}_getCommandString(e,r){let n=this._getSpawnFileName(),i=this._getSpawnArgs(e),o=r?"":"[command]";if(Ze)if(this._isCmdFile()){o+=n;for(let s of i)o+=` ${s}`}else if(e.windowsVerbatimArguments){o+=`"${n}"`;for(let s of i)o+=` ${s}`}else{o+=this._windowsQuoteCmdArg(n);for(let s of i)o+=` ${this._windowsQuoteCmdArg(s)}`}else{o+=n;for(let s of i)o+=` ${s}`}return o}_processLineBuffer(e,r,n){try{let i=r+e.toString(),o=i.indexOf(Xe.EOL);for(;o>-1;){let s=i.substring(0,o);n(s),i=i.substring(o+Xe.EOL.length),o=i.indexOf(Xe.EOL)}return i}catch(i){return this._debug(`error processing line. Failed with error ${i}`),""}}_getSpawnFileName(){return Ze&&this._isCmdFile()?process.env.COMSPEC||"cmd.exe":this.toolPath}_getSpawnArgs(e){if(Ze&&this._isCmdFile()){let r=`/D /S /C "${this._windowsQuoteCmdArg(this.toolPath)}`;for(let n of this.args)r+=" ",r+=e.windowsVerbatimArguments?n:this._windowsQuoteCmdArg(n);return r+='"',[r]}return this.args}_endsWith(e,r){return e.endsWith(r)}_isCmdFile(){let e=this.toolPath.toUpperCase();return this._endsWith(e,".CMD")||this._endsWith(e,".BAT")}_windowsQuoteCmdArg(e){if(!this._isCmdFile())return this._uvQuoteCmdArg(e);if(!e)return'""';let r=[" ","	","&","(",")","[","]","{","}","^","=",";","!","'","+",",","`","~","|","<",">",'"'],n=!1;for(let s of e)if(r.some(u=>u===s)){n=!0;break}if(!n)return e;let i='"',o=!0;for(let s=e.length;s>0;s--)i+=e[s-1],o&&e[s-1]==="\\"?i+="\\":e[s-1]==='"'?(o=!0,i+='"'):o=!1;return i+='"',i.split("").reverse().join("")}_uvQuoteCmdArg(e){if(!e)return'""';if(!e.includes(" ")&&!e.includes("	")&&!e.includes('"'))return e;if(!e.includes('"')&&!e.includes("\\"))return`"${e}"`;let r='"',n=!0;for(let i=e.length;i>0;i--)r+=e[i-1],n&&e[i-1]==="\\"?r+="\\":e[i-1]==='"'?(n=!0,r+="\\"):n=!1;return r+='"',r.split("").reverse().join("")}_cloneExecOptions(e){e=e||{};let r={cwd:e.cwd||process.cwd(),env:e.env||process.env,silent:e.silent||!1,windowsVerbatimArguments:e.windowsVerbatimArguments||!1,failOnStdErr:e.failOnStdErr||!1,ignoreReturnCode:e.ignoreReturnCode||!1,delay:e.delay||1e4};return r.outStream=e.outStream||process.stdout,r.errStream=e.errStream||process.stderr,r}_getSpawnOptions(e,r){e=e||{};let n={};return n.cwd=e.cwd,n.env=e.env,n.windowsVerbatimArguments=e.windowsVerbatimArguments||this._isCmdFile(),e.windowsVerbatimArguments&&(n.argv0=`"${r}"`),n}exec(){return Zr(this,void 0,void 0,function*(){return!en.isRooted(this.toolPath)&&(this.toolPath.includes("/")||Ze&&this.toolPath.includes("\\"))&&(this.toolPath=ys.resolve(process.cwd(),this.options.cwd||process.cwd(),this.toolPath)),this.toolPath=yield vs.which(this.toolPath,!0),new Promise((e,r)=>Zr(this,void 0,void 0,function*(){this._debug(`exec tool: ${this.toolPath}`),this._debug("arguments:");for(let a of this.args)this._debug(`   ${a}`);let n=this._cloneExecOptions(this.options);!n.silent&&n.outStream&&n.outStream.write(this._getCommandString(n)+Xe.EOL);let i=new xe(n,this.toolPath);if(i.on("debug",a=>{this._debug(a)}),this.options.cwd&&!(yield en.exists(this.options.cwd)))return r(new Error(`The cwd: ${this.options.cwd} does not exist!`));let o=this._getSpawnFileName(),s=gs.spawn(o,this._getSpawnArgs(n),this._getSpawnOptions(this.options,o)),u="";s.stdout&&s.stdout.on("data",a=>{this.options.listeners&&this.options.listeners.stdout&&this.options.listeners.stdout(a),!n.silent&&n.outStream&&n.outStream.write(a),u=this._processLineBuffer(a,u,l=>{this.options.listeners&&this.options.listeners.stdline&&this.options.listeners.stdline(l)})});let c="";if(s.stderr&&s.stderr.on("data",a=>{i.processStderr=!0,this.options.listeners&&this.options.listeners.stderr&&this.options.listeners.stderr(a),!n.silent&&n.errStream&&n.outStream&&(n.failOnStdErr?n.errStream:n.outStream).write(a),c=this._processLineBuffer(a,c,l=>{this.options.listeners&&this.options.listeners.errline&&this.options.listeners.errline(l)})}),s.on("error",a=>{i.processError=a.message,i.processExited=!0,i.processClosed=!0,i.CheckComplete()}),s.on("exit",a=>{i.processExitCode=a,i.processExited=!0,this._debug(`Exit code ${a} received from tool '${this.toolPath}'`),i.CheckComplete()}),s.on("close",a=>{i.processExitCode=a,i.processExited=!0,i.processClosed=!0,this._debug(`STDIO streams have closed for tool '${this.toolPath}'`),i.CheckComplete()}),i.on("done",(a,l)=>{u.length>0&&this.emit("stdline",u),c.length>0&&this.emit("errline",c),s.removeAllListeners(),a?r(a):e(l)}),this.options.input){if(!s.stdin)throw new Error("child process missing stdin");s.stdin.end(this.options.input)}}))})}};B.ToolRunner=$t;function bs(t){let e=[],r=!1,n=!1,i="";function o(s){n&&s!=='"'&&(i+="\\"),i+=s,n=!1}for(let s=0;s<t.length;s++){let u=t.charAt(s);if(u==='"'){n?o(u):r=!r;continue}if(u==="\\"&&n){o(u);continue}if(u==="\\"&&r){n=!0;continue}if(u===" "&&!r){i.length>0&&(e.push(i),i="");continue}o(u)}return i.length>0&&e.push(i.trim()),e}B.argStringToArray=bs;var xe=class extends tn.EventEmitter{constructor(e,r){if(super(),this.processClosed=!1,this.processError="",this.processExitCode=0,this.processExited=!1,this.processStderr=!1,this.delay=1e4,this.done=!1,this.timeout=null,!r)throw new Error("toolPath must not be empty");this.options=e,this.toolPath=r,e.delay&&(this.delay=e.delay)}CheckComplete(){this.done||(this.processClosed?this._setResult():this.processExited&&(this.timeout=ws.setTimeout(xe.HandleTimeout,this.delay,this)))}_debug(e){this.emit("debug",e)}_setResult(){let e;this.processExited&&(this.processError?e=new Error(`There was an error when attempting to execute the process '${this.toolPath}'. This may indicate the process failed to start. Error: ${this.processError}`):this.processExitCode!==0&&!this.options.ignoreReturnCode?e=new Error(`The process '${this.toolPath}' failed with exit code ${this.processExitCode}`):this.processStderr&&this.options.failOnStdErr&&(e=new Error(`The process '${this.toolPath}' failed because one or more lines were written to the STDERR stream`))),this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.done=!0,this.emit("done",e,this.processExitCode)}static HandleTimeout(e){if(!e.done){if(!e.processClosed&&e.processExited){let r=`The STDIO streams did not close within ${e.delay/1e3} seconds of the exit event from process '${e.toolPath}'. This may indicate a child process inherited the STDIO streams and has not yet exited.`;e._debug(r)}e._setResult()}}}});var an=v(L=>{"use strict";var Os=L&&L.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ss=L&&L.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Es=L&&L.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.hasOwnProperty.call(t,r)&&Os(e,t,r);return Ss(e,t),e},sn=L&&L.__awaiter||function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function u(l){try{a(n.next(l))}catch(f){s(f)}}function c(l){try{a(n.throw(l))}catch(f){s(f)}}function a(l){l.done?o(l.value):i(l.value).then(u,c)}a((n=n.apply(t,e||[])).next())})};Object.defineProperty(L,"__esModule",{value:!0});L.getExecOutput=L.exec=void 0;var nn=require("string_decoder"),on=Es(rn());function un(t,e,r){return sn(this,void 0,void 0,function*(){let n=on.argStringToArray(t);if(n.length===0)throw new Error("Parameter 'commandLine' cannot be null or empty.");let i=n[0];return e=n.slice(1).concat(e||[]),new on.ToolRunner(i,e,r).exec()})}L.exec=un;function xs(t,e,r){var n,i;return sn(this,void 0,void 0,function*(){let o="",s="",u=new nn.StringDecoder("utf8"),c=new nn.StringDecoder("utf8"),a=(n=r==null?void 0:r.listeners)===null||n===void 0?void 0:n.stdout,l=(i=r==null?void 0:r.listeners)===null||i===void 0?void 0:i.stderr,f=S=>{s+=c.write(S),l&&l(S)},_=S=>{o+=u.write(S),a&&a(S)},N=Object.assign(Object.assign({},r==null?void 0:r.listeners),{stdout:_,stderr:f}),U=yield un(t,e,Object.assign(Object.assign({},r),{listeners:N}));return o+=u.end(),s+=c.end(),{exitCode:U,stdout:o,stderr:s}})}L.getExecOutput=xs});var A=J(Se()),pn=J(require("fs"));var x=J(Se());var p=class extends Error{constructor(e,r,n,...i){Array.isArray(r)&&(r=r.join(" ").trim()),super(r),Error.captureStackTrace!==void 0&&Error.captureStackTrace(this,p),this.code=e;for(let o of i)for(let s in o){let u=o[s];this[s]=Buffer.isBuffer(u)?u.toString(n.encoding):u==null?u:JSON.parse(JSON.stringify(u))}}};var Dr=function(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)};var He=function(t){let e=[];for(let r=0,n=t.length;r<n;r++){let i=t[r];if(i==null||i===!1)e[r]={disabled:!0};else if(typeof i=="string")e[r]={name:i};else if(Dr(i)){if(typeof i.name!="string")throw new p("CSV_OPTION_COLUMNS_MISSING_NAME",["Option columns missing name:",`property "name" is required at position ${r}`,"when column is an object literal"]);e[r]=i}else throw new p("CSV_INVALID_COLUMN_DEFINITION",["Invalid column definition:","expect a string or a literal object,",`got ${JSON.stringify(i)} at position ${r}`])}return e};var Rt=class{constructor(e=100){this.size=e,this.length=0,this.buf=Buffer.allocUnsafe(e)}prepend(e){if(Buffer.isBuffer(e)){let r=this.length+e.length;if(r>=this.size&&(this.resize(),r>=this.size))throw Error("INVALID_BUFFER_STATE");let n=this.buf;this.buf=Buffer.allocUnsafe(this.size),e.copy(this.buf,0),n.copy(this.buf,e.length),this.length+=e.length}else{let r=this.length++;r===this.size&&this.resize();let n=this.clone();this.buf[0]=e,n.copy(this.buf,1,0,r)}}append(e){let r=this.length++;r===this.size&&this.resize(),this.buf[r]=e}clone(){return Buffer.from(this.buf.slice(0,this.length))}resize(){let e=this.length;this.size=this.size*2;let r=Buffer.allocUnsafe(this.size);this.buf.copy(r,0,0,e),this.buf=r}toString(e){return e?this.buf.slice(0,this.length).toString(e):Uint8Array.prototype.slice.call(this.buf.slice(0,this.length))}toJSON(){return this.toString("utf8")}reset(){this.length=0}},Tt=Rt;var zo=12,Go=13,Qo=10,Wo=32,Ho=9,Ar=function(t){return{bomSkipped:!1,bufBytesStart:0,castField:t.cast_function,commenting:!1,error:void 0,enabled:t.from_line===1,escaping:!1,escapeIsQuote:Buffer.isBuffer(t.escape)&&Buffer.isBuffer(t.quote)&&Buffer.compare(t.escape,t.quote)===0,expectedRecordLength:Array.isArray(t.columns)?t.columns.length:void 0,field:new Tt(20),firstLineToHeaders:t.cast_first_line_to_header,needMoreDataSize:Math.max(t.comment!==null?t.comment.length:0,...t.delimiter.map(e=>e.length),t.quote!==null?t.quote.length:0),previousBuf:void 0,quoting:!1,stop:!1,rawBuffer:new Tt(100),record:[],recordHasError:!1,record_length:0,recordDelimiterMaxLength:t.record_delimiter.length===0?0:Math.max(...t.record_delimiter.map(e=>e.length)),trimChars:[Buffer.from(" ",t.encoding)[0],Buffer.from("	",t.encoding)[0]],wasQuoting:!1,wasRowDelimiter:!1,timchars:[Buffer.from(Buffer.from([Go],"utf8").toString(),t.encoding),Buffer.from(Buffer.from([Qo],"utf8").toString(),t.encoding),Buffer.from(Buffer.from([zo],"utf8").toString(),t.encoding),Buffer.from(Buffer.from([Wo],"utf8").toString(),t.encoding),Buffer.from(Buffer.from([Ho],"utf8").toString(),t.encoding)]}};var qr=function(t){return t.replace(/([A-Z])/g,function(e,r){return"_"+r.toLowerCase()})};var Nt=function(t){let e={};for(let n in t)e[qr(n)]=t[n];if(e.encoding===void 0||e.encoding===!0)e.encoding="utf8";else if(e.encoding===null||e.encoding===!1)e.encoding=null;else if(typeof e.encoding!="string"&&e.encoding!==null)throw new p("CSV_INVALID_OPTION_ENCODING",["Invalid option encoding:","encoding must be a string or null to return a buffer,",`got ${JSON.stringify(e.encoding)}`],e);if(e.bom===void 0||e.bom===null||e.bom===!1)e.bom=!1;else if(e.bom!==!0)throw new p("CSV_INVALID_OPTION_BOM",["Invalid option bom:","bom must be true,",`got ${JSON.stringify(e.bom)}`],e);if(e.cast_function=null,e.cast===void 0||e.cast===null||e.cast===!1||e.cast==="")e.cast=void 0;else if(typeof e.cast=="function")e.cast_function=e.cast,e.cast=!0;else if(e.cast!==!0)throw new p("CSV_INVALID_OPTION_CAST",["Invalid option cast:","cast must be true or a function,",`got ${JSON.stringify(e.cast)}`],e);if(e.cast_date===void 0||e.cast_date===null||e.cast_date===!1||e.cast_date==="")e.cast_date=!1;else if(e.cast_date===!0)e.cast_date=function(n){let i=Date.parse(n);return isNaN(i)?n:new Date(i)};else if(typeof e.cast_date!="function")throw new p("CSV_INVALID_OPTION_CAST_DATE",["Invalid option cast_date:","cast_date must be true or a function,",`got ${JSON.stringify(e.cast_date)}`],e);if(e.cast_first_line_to_header=null,e.columns===!0)e.cast_first_line_to_header=void 0;else if(typeof e.columns=="function")e.cast_first_line_to_header=e.columns,e.columns=!0;else if(Array.isArray(e.columns))e.columns=He(e.columns);else if(e.columns===void 0||e.columns===null||e.columns===!1)e.columns=!1;else throw new p("CSV_INVALID_OPTION_COLUMNS",["Invalid option columns:","expect an array, a function or true,",`got ${JSON.stringify(e.columns)}`],e);if(e.group_columns_by_name===void 0||e.group_columns_by_name===null||e.group_columns_by_name===!1)e.group_columns_by_name=!1;else{if(e.group_columns_by_name!==!0)throw new p("CSV_INVALID_OPTION_GROUP_COLUMNS_BY_NAME",["Invalid option group_columns_by_name:","expect an boolean,",`got ${JSON.stringify(e.group_columns_by_name)}`],e);if(e.columns===!1)throw new p("CSV_INVALID_OPTION_GROUP_COLUMNS_BY_NAME",["Invalid option group_columns_by_name:","the `columns` mode must be activated."],e)}if(e.comment===void 0||e.comment===null||e.comment===!1||e.comment==="")e.comment=null;else if(typeof e.comment=="string"&&(e.comment=Buffer.from(e.comment,e.encoding)),!Buffer.isBuffer(e.comment))throw new p("CSV_INVALID_OPTION_COMMENT",["Invalid option comment:","comment must be a buffer or a string,",`got ${JSON.stringify(e.comment)}`],e);let r=JSON.stringify(e.delimiter);if(Array.isArray(e.delimiter)||(e.delimiter=[e.delimiter]),e.delimiter.length===0)throw new p("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,",`got ${r}`],e);if(e.delimiter=e.delimiter.map(function(n){if(n==null||n===!1)return Buffer.from(",",e.encoding);if(typeof n=="string"&&(n=Buffer.from(n,e.encoding)),!Buffer.isBuffer(n)||n.length===0)throw new p("CSV_INVALID_OPTION_DELIMITER",["Invalid option delimiter:","delimiter must be a non empty string or buffer or array of string|buffer,",`got ${r}`],e);return n}),e.escape===void 0||e.escape===!0?e.escape=Buffer.from('"',e.encoding):typeof e.escape=="string"?e.escape=Buffer.from(e.escape,e.encoding):(e.escape===null||e.escape===!1)&&(e.escape=null),e.escape!==null&&!Buffer.isBuffer(e.escape))throw new Error(`Invalid Option: escape must be a buffer, a string or a boolean, got ${JSON.stringify(e.escape)}`);if(e.from===void 0||e.from===null)e.from=1;else if(typeof e.from=="string"&&/\d+/.test(e.from)&&(e.from=parseInt(e.from)),Number.isInteger(e.from)){if(e.from<0)throw new Error(`Invalid Option: from must be a positive integer, got ${JSON.stringify(t.from)}`)}else throw new Error(`Invalid Option: from must be an integer, got ${JSON.stringify(e.from)}`);if(e.from_line===void 0||e.from_line===null)e.from_line=1;else if(typeof e.from_line=="string"&&/\d+/.test(e.from_line)&&(e.from_line=parseInt(e.from_line)),Number.isInteger(e.from_line)){if(e.from_line<=0)throw new Error(`Invalid Option: from_line must be a positive integer greater than 0, got ${JSON.stringify(t.from_line)}`)}else throw new Error(`Invalid Option: from_line must be an integer, got ${JSON.stringify(t.from_line)}`);if(e.ignore_last_delimiters===void 0||e.ignore_last_delimiters===null)e.ignore_last_delimiters=!1;else if(typeof e.ignore_last_delimiters=="number")e.ignore_last_delimiters=Math.floor(e.ignore_last_delimiters),e.ignore_last_delimiters===0&&(e.ignore_last_delimiters=!1);else if(typeof e.ignore_last_delimiters!="boolean")throw new p("CSV_INVALID_OPTION_IGNORE_LAST_DELIMITERS",["Invalid option `ignore_last_delimiters`:","the value must be a boolean value or an integer,",`got ${JSON.stringify(e.ignore_last_delimiters)}`],e);if(e.ignore_last_delimiters===!0&&e.columns===!1)throw new p("CSV_IGNORE_LAST_DELIMITERS_REQUIRES_COLUMNS",["The option `ignore_last_delimiters`","requires the activation of the `columns` option"],e);if(e.info===void 0||e.info===null||e.info===!1)e.info=!1;else if(e.info!==!0)throw new Error(`Invalid Option: info must be true, got ${JSON.stringify(e.info)}`);if(e.max_record_size===void 0||e.max_record_size===null||e.max_record_size===!1)e.max_record_size=0;else if(!(Number.isInteger(e.max_record_size)&&e.max_record_size>=0))if(typeof e.max_record_size=="string"&&/\d+/.test(e.max_record_size))e.max_record_size=parseInt(e.max_record_size);else throw new Error(`Invalid Option: max_record_size must be a positive integer, got ${JSON.stringify(e.max_record_size)}`);if(e.objname===void 0||e.objname===null||e.objname===!1)e.objname=void 0;else if(Buffer.isBuffer(e.objname)){if(e.objname.length===0)throw new Error("Invalid Option: objname must be a non empty buffer");e.encoding===null||(e.objname=e.objname.toString(e.encoding))}else if(typeof e.objname=="string"){if(e.objname.length===0)throw new Error("Invalid Option: objname must be a non empty string")}else if(typeof e.objname!="number")throw new Error(`Invalid Option: objname must be a string or a buffer, got ${e.objname}`);if(e.objname!==void 0){if(typeof e.objname=="number"){if(e.columns!==!1)throw Error("Invalid Option: objname index cannot be combined with columns or be defined as a field")}else if(e.columns===!1)throw Error("Invalid Option: objname field must be combined with columns or be defined as an index")}if(e.on_record===void 0||e.on_record===null)e.on_record=void 0;else if(typeof e.on_record!="function")throw new p("CSV_INVALID_OPTION_ON_RECORD",["Invalid option `on_record`:","expect a function,",`got ${JSON.stringify(e.on_record)}`],e);if(e.quote===null||e.quote===!1||e.quote==="")e.quote=null;else if(e.quote===void 0||e.quote===!0?e.quote=Buffer.from('"',e.encoding):typeof e.quote=="string"&&(e.quote=Buffer.from(e.quote,e.encoding)),!Buffer.isBuffer(e.quote))throw new Error(`Invalid Option: quote must be a buffer or a string, got ${JSON.stringify(e.quote)}`);if(e.raw===void 0||e.raw===null||e.raw===!1)e.raw=!1;else if(e.raw!==!0)throw new Error(`Invalid Option: raw must be true, got ${JSON.stringify(e.raw)}`);if(e.record_delimiter===void 0)e.record_delimiter=[];else if(typeof e.record_delimiter=="string"||Buffer.isBuffer(e.record_delimiter)){if(e.record_delimiter.length===0)throw new p("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a non empty string or buffer,",`got ${JSON.stringify(e.record_delimiter)}`],e);e.record_delimiter=[e.record_delimiter]}else if(!Array.isArray(e.record_delimiter))throw new p("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a string, a buffer or array of string|buffer,",`got ${JSON.stringify(e.record_delimiter)}`],e);if(e.record_delimiter=e.record_delimiter.map(function(n,i){if(typeof n!="string"&&!Buffer.isBuffer(n))throw new p("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a string, a buffer or array of string|buffer",`at index ${i},`,`got ${JSON.stringify(n)}`],e);if(n.length===0)throw new p("CSV_INVALID_OPTION_RECORD_DELIMITER",["Invalid option `record_delimiter`:","value must be a non empty string or buffer",`at index ${i},`,`got ${JSON.stringify(n)}`],e);return typeof n=="string"&&(n=Buffer.from(n,e.encoding)),n}),typeof e.relax_column_count!="boolean")if(e.relax_column_count===void 0||e.relax_column_count===null)e.relax_column_count=!1;else throw new Error(`Invalid Option: relax_column_count must be a boolean, got ${JSON.stringify(e.relax_column_count)}`);if(typeof e.relax_column_count_less!="boolean")if(e.relax_column_count_less===void 0||e.relax_column_count_less===null)e.relax_column_count_less=!1;else throw new Error(`Invalid Option: relax_column_count_less must be a boolean, got ${JSON.stringify(e.relax_column_count_less)}`);if(typeof e.relax_column_count_more!="boolean")if(e.relax_column_count_more===void 0||e.relax_column_count_more===null)e.relax_column_count_more=!1;else throw new Error(`Invalid Option: relax_column_count_more must be a boolean, got ${JSON.stringify(e.relax_column_count_more)}`);if(typeof e.relax_quotes!="boolean")if(e.relax_quotes===void 0||e.relax_quotes===null)e.relax_quotes=!1;else throw new Error(`Invalid Option: relax_quotes must be a boolean, got ${JSON.stringify(e.relax_quotes)}`);if(typeof e.skip_empty_lines!="boolean")if(e.skip_empty_lines===void 0||e.skip_empty_lines===null)e.skip_empty_lines=!1;else throw new Error(`Invalid Option: skip_empty_lines must be a boolean, got ${JSON.stringify(e.skip_empty_lines)}`);if(typeof e.skip_records_with_empty_values!="boolean")if(e.skip_records_with_empty_values===void 0||e.skip_records_with_empty_values===null)e.skip_records_with_empty_values=!1;else throw new Error(`Invalid Option: skip_records_with_empty_values must be a boolean, got ${JSON.stringify(e.skip_records_with_empty_values)}`);if(typeof e.skip_records_with_error!="boolean")if(e.skip_records_with_error===void 0||e.skip_records_with_error===null)e.skip_records_with_error=!1;else throw new Error(`Invalid Option: skip_records_with_error must be a boolean, got ${JSON.stringify(e.skip_records_with_error)}`);if(e.rtrim===void 0||e.rtrim===null||e.rtrim===!1)e.rtrim=!1;else if(e.rtrim!==!0)throw new Error(`Invalid Option: rtrim must be a boolean, got ${JSON.stringify(e.rtrim)}`);if(e.ltrim===void 0||e.ltrim===null||e.ltrim===!1)e.ltrim=!1;else if(e.ltrim!==!0)throw new Error(`Invalid Option: ltrim must be a boolean, got ${JSON.stringify(e.ltrim)}`);if(e.trim===void 0||e.trim===null||e.trim===!1)e.trim=!1;else if(e.trim!==!0)throw new Error(`Invalid Option: trim must be a boolean, got ${JSON.stringify(e.trim)}`);if(e.trim===!0&&t.ltrim!==!1?e.ltrim=!0:e.ltrim!==!0&&(e.ltrim=!1),e.trim===!0&&t.rtrim!==!1?e.rtrim=!0:e.rtrim!==!0&&(e.rtrim=!1),e.to===void 0||e.to===null)e.to=-1;else if(typeof e.to=="string"&&/\d+/.test(e.to)&&(e.to=parseInt(e.to)),Number.isInteger(e.to)){if(e.to<=0)throw new Error(`Invalid Option: to must be a positive integer greater than 0, got ${JSON.stringify(t.to)}`)}else throw new Error(`Invalid Option: to must be an integer, got ${JSON.stringify(t.to)}`);if(e.to_line===void 0||e.to_line===null)e.to_line=-1;else if(typeof e.to_line=="string"&&/\d+/.test(e.to_line)&&(e.to_line=parseInt(e.to_line)),Number.isInteger(e.to_line)){if(e.to_line<=0)throw new Error(`Invalid Option: to_line must be a positive integer greater than 0, got ${JSON.stringify(t.to_line)}`)}else throw new Error(`Invalid Option: to_line must be an integer, got ${JSON.stringify(t.to_line)}`);return e};var Mr=function(t){return t.every(e=>e==null||e.toString&&e.toString().trim()==="")},Ko=13,Yo=10,me={utf8:Buffer.from([239,187,191]),utf16le:Buffer.from([255,254])},$r=function(t={}){let e={bytes:0,comment_lines:0,empty_lines:0,invalid_field_length:0,lines:1,records:0},r=Nt(t);return{info:e,original_options:t,options:r,state:Ar(r),__needMoreData:function(n,i,o){if(o)return!1;let{encoding:s,escape:u,quote:c}=this.options,{quoting:a,needMoreDataSize:l,recordDelimiterMaxLength:f}=this.state,_=i-n-1,N=Math.max(l,f===0?Buffer.from(`\r
`,s).length:f,a?(u===null?0:u.length)+c.length:0,a?c.length+f:0);return _<N},parse:function(n,i,o,s){let{bom:u,encoding:c,from_line:a,ltrim:l,max_record_size:f,raw:_,relax_quotes:N,rtrim:U,skip_empty_lines:S,to:K,to_line:q}=this.options,{comment:O,escape:y,quote:C,record_delimiter:tt}=this.options,{bomSkipped:gn,previousBuf:Re,rawBuffer:yn,escapeIsQuote:vn}=this.state,w;if(Re===void 0)if(n===void 0){s();return}else w=n;else Re!==void 0&&n===void 0?w=Re:w=Buffer.concat([Re,n]);if(gn===!1)if(u===!1)this.state.bomSkipped=!0;else if(w.length<3){if(i===!1){this.state.previousBuf=w;return}}else{for(let I in me)if(me[I].compare(w,0,me[I].length)===0){let Z=me[I].length;this.state.bufBytesStart+=Z,w=w.slice(Z),this.options=Nt({...this.original_options,encoding:I}),{comment:O,escape:y,quote:C}=this.options;break}this.state.bomSkipped=!0}let rt=w.length,m;for(m=0;m<rt&&!this.__needMoreData(m,rt,i);m++){if(this.state.wasRowDelimiter===!0&&(this.info.lines++,this.state.wasRowDelimiter=!1),q!==-1&&this.info.lines>q){this.state.stop=!0,s();return}this.state.quoting===!1&&tt.length===0&&this.__autoDiscoverRecordDelimiter(w,m)&&(tt=this.options.record_delimiter);let I=w[m];if(_===!0&&yn.append(I),(I===Ko||I===Yo)&&this.state.wasRowDelimiter===!1&&(this.state.wasRowDelimiter=!0),this.state.escaping===!0)this.state.escaping=!1;else{if(y!==null&&this.state.quoting===!0&&this.__isEscape(w,m,I)&&m+y.length<rt)if(vn){if(this.__isQuote(w,m+y.length)){this.state.escaping=!0,m+=y.length-1;continue}}else{this.state.escaping=!0,m+=y.length-1;continue}if(this.state.commenting===!1&&this.__isQuote(w,m))if(this.state.quoting===!0){let P=w[m+C.length],ve=U&&this.__isCharTrimable(w,m+C.length),oe=O!==null&&this.__compareBytes(O,w,m+C.length,P),ee=this.__isDelimiter(w,m+C.length,P),Te=tt.length===0?this.__autoDiscoverRecordDelimiter(w,m+C.length):this.__isRecordDelimiter(P,w,m+C.length);if(y!==null&&this.__isEscape(w,m,I)&&this.__isQuote(w,m+y.length))m+=y.length-1;else if(!P||ee||Te||oe||ve){this.state.quoting=!1,this.state.wasQuoting=!0,m+=C.length-1;continue}else if(N===!1){let we=this.__error(new p("CSV_INVALID_CLOSING_QUOTE",["Invalid Closing Quote:",`got "${String.fromCharCode(P)}"`,`at line ${this.info.lines}`,"instead of delimiter, record delimiter, trimable character","(if activated) or comment"],this.options,this.__infoField()));if(we!==void 0)return we}else this.state.quoting=!1,this.state.wasQuoting=!0,this.state.field.prepend(C),m+=C.length-1}else if(this.state.field.length!==0){if(N===!1){let P=this.__infoField(),ve=Object.keys(me).map(ee=>me[ee].equals(this.state.field.toString())?ee:!1).filter(Boolean)[0],oe=this.__error(new p("INVALID_OPENING_QUOTE",["Invalid Opening Quote:",`a quote is found on field ${JSON.stringify(P.column)} at line ${P.lines}, value is ${JSON.stringify(this.state.field.toString(c))}`,ve?`(${ve} bom)`:void 0],this.options,P,{field:this.state.field}));if(oe!==void 0)return oe}}else{this.state.quoting=!0,m+=C.length-1;continue}if(this.state.quoting===!1){let P=this.__isRecordDelimiter(I,w,m);if(P!==0){if(this.state.commenting&&this.state.wasQuoting===!1&&this.state.record.length===0&&this.state.field.length===0)this.info.comment_lines++;else{if(this.state.enabled===!1&&this.info.lines+(this.state.wasRowDelimiter===!0?1:0)>=a){this.state.enabled=!0,this.__resetField(),this.__resetRecord(),m+=P-1;continue}if(S===!0&&this.state.wasQuoting===!1&&this.state.record.length===0&&this.state.field.length===0){this.info.empty_lines++,m+=P-1;continue}this.info.bytes=this.state.bufBytesStart+m;let Te=this.__onField();if(Te!==void 0)return Te;this.info.bytes=this.state.bufBytesStart+m+P;let we=this.__onRecord(o);if(we!==void 0)return we;if(K!==-1&&this.info.records>=K){this.state.stop=!0,s();return}}this.state.commenting=!1,m+=P-1;continue}if(this.state.commenting)continue;if((O===null?0:this.__compareBytes(O,w,m,I))!==0){this.state.commenting=!0;continue}let oe=this.__isDelimiter(w,m,I);if(oe!==0){this.info.bytes=this.state.bufBytesStart+m;let ee=this.__onField();if(ee!==void 0)return ee;m+=oe-1;continue}}}if(this.state.commenting===!1&&f!==0&&this.state.record_length+this.state.field.length>f)return this.__error(new p("CSV_MAX_RECORD_SIZE",["Max Record Size:","record exceed the maximum number of tolerated bytes",`of ${f}`,`at line ${this.info.lines}`],this.options,this.__infoField()));let Z=l===!1||this.state.quoting===!0||this.state.field.length!==0||!this.__isCharTrimable(w,m),wn=U===!1||this.state.wasQuoting===!1;if(Z===!0&&wn===!0)this.state.field.append(I);else{if(U===!0&&!this.__isCharTrimable(w,m))return this.__error(new p("CSV_NON_TRIMABLE_CHAR_AFTER_CLOSING_QUOTE",["Invalid Closing Quote:","found non trimable byte after quote",`at line ${this.info.lines}`],this.options,this.__infoField()));Z===!1&&(m+=this.__isCharTrimable(w,m)-1);continue}}if(i===!0)if(this.state.quoting===!0){let I=this.__error(new p("CSV_QUOTE_NOT_CLOSED",["Quote Not Closed:",`the parsing is finished with an opening quote at line ${this.info.lines}`],this.options,this.__infoField()));if(I!==void 0)return I}else if(this.state.wasQuoting===!0||this.state.record.length!==0||this.state.field.length!==0){this.info.bytes=this.state.bufBytesStart+m;let I=this.__onField();if(I!==void 0)return I;let Z=this.__onRecord(o);if(Z!==void 0)return Z}else this.state.wasRowDelimiter===!0?this.info.empty_lines++:this.state.commenting===!0&&this.info.comment_lines++;else this.state.bufBytesStart+=m,this.state.previousBuf=w.slice(m);this.state.wasRowDelimiter===!0&&(this.info.lines++,this.state.wasRowDelimiter=!1)},__onRecord:function(n){let{columns:i,group_columns_by_name:o,encoding:s,info:u,from:c,relax_column_count:a,relax_column_count_less:l,relax_column_count_more:f,raw:_,skip_records_with_empty_values:N}=this.options,{enabled:U,record:S}=this.state;if(U===!1)return this.__resetRecord();let K=S.length;if(i===!0){if(N===!0&&Mr(S)){this.__resetRecord();return}return this.__firstLineToColumns(S)}if(i===!1&&this.info.records===0&&(this.state.expectedRecordLength=K),K!==this.state.expectedRecordLength){let q=i===!1?new p("CSV_RECORD_INCONSISTENT_FIELDS_LENGTH",["Invalid Record Length:",`expect ${this.state.expectedRecordLength},`,`got ${K} on line ${this.info.lines}`],this.options,this.__infoField(),{record:S}):new p("CSV_RECORD_INCONSISTENT_COLUMNS",["Invalid Record Length:",`columns length is ${i.length},`,`got ${K} on line ${this.info.lines}`],this.options,this.__infoField(),{record:S});if(a===!0||l===!0&&K<this.state.expectedRecordLength||f===!0&&K>this.state.expectedRecordLength)this.info.invalid_field_length++,this.state.error=q;else{let O=this.__error(q);if(O)return O}}if(N===!0&&Mr(S)){this.__resetRecord();return}if(this.state.recordHasError===!0){this.__resetRecord(),this.state.recordHasError=!1;return}if(this.info.records++,c===1||this.info.records>=c){let{objname:q}=this.options;if(i!==!1){let O={};for(let y=0,C=S.length;y<C;y++)i[y]===void 0||i[y].disabled||(o===!0&&O[i[y].name]!==void 0?Array.isArray(O[i[y].name])?O[i[y].name]=O[i[y].name].concat(S[y]):O[i[y].name]=[O[i[y].name],S[y]]:O[i[y].name]=S[y]);if(_===!0||u===!0){let y=Object.assign({record:O},_===!0?{raw:this.state.rawBuffer.toString(s)}:{},u===!0?{info:this.__infoRecord()}:{}),C=this.__push(q===void 0?y:[O[q],y],n);if(C)return C}else{let y=this.__push(q===void 0?O:[O[q],O],n);if(y)return y}}else if(_===!0||u===!0){let O=Object.assign({record:S},_===!0?{raw:this.state.rawBuffer.toString(s)}:{},u===!0?{info:this.__infoRecord()}:{}),y=this.__push(q===void 0?O:[S[q],O],n);if(y)return y}else{let O=this.__push(q===void 0?S:[S[q],S],n);if(O)return O}}this.__resetRecord()},__firstLineToColumns:function(n){let{firstLineToHeaders:i}=this.state;try{let o=i===void 0?n:i.call(null,n);if(!Array.isArray(o))return this.__error(new p("CSV_INVALID_COLUMN_MAPPING",["Invalid Column Mapping:","expect an array from column function,",`got ${JSON.stringify(o)}`],this.options,this.__infoField(),{headers:o}));let s=He(o);this.state.expectedRecordLength=s.length,this.options.columns=s,this.__resetRecord();return}catch(o){return o}},__resetRecord:function(){this.options.raw===!0&&this.state.rawBuffer.reset(),this.state.error=void 0,this.state.record=[],this.state.record_length=0},__onField:function(){let{cast:n,encoding:i,rtrim:o,max_record_size:s}=this.options,{enabled:u,wasQuoting:c}=this.state;if(u===!1)return this.__resetField();let a=this.state.field.toString(i);if(o===!0&&c===!1&&(a=a.trimRight()),n===!0){let[l,f]=this.__cast(a);if(l!==void 0)return l;a=f}this.state.record.push(a),s!==0&&typeof a=="string"&&(this.state.record_length+=a.length),this.__resetField()},__resetField:function(){this.state.field.reset(),this.state.wasQuoting=!1},__push:function(n,i){let{on_record:o}=this.options;if(o!==void 0){let s=this.__infoRecord();try{n=o.call(null,n,s)}catch(u){return u}if(n==null)return}i(n)},__cast:function(n){let{columns:i,relax_column_count:o}=this.options;if(Array.isArray(i)===!0&&o&&this.options.columns.length<=this.state.record.length)return[void 0,void 0];if(this.state.castField!==null)try{let u=this.__infoField();return[void 0,this.state.castField.call(null,n,u)]}catch(u){return[u]}if(this.__isFloat(n))return[void 0,parseFloat(n)];if(this.options.cast_date!==!1){let u=this.__infoField();return[void 0,this.options.cast_date.call(null,n,u)]}return[void 0,n]},__isCharTrimable:function(n,i){return((s,u)=>{let{timchars:c}=this.state;e:for(let a=0;a<c.length;a++){let l=c[a];for(let f=0;f<l.length;f++)if(l[f]!==s[u+f])continue e;return l.length}return 0})(n,i)},__isFloat:function(n){return n-parseFloat(n)+1>=0},__compareBytes:function(n,i,o,s){if(n[0]!==s)return 0;let u=n.length;for(let c=1;c<u;c++)if(n[c]!==i[o+c])return 0;return u},__isDelimiter:function(n,i,o){let{delimiter:s,ignore_last_delimiters:u}=this.options;if(u===!0&&this.state.record.length===this.options.columns.length-1)return 0;if(u!==!1&&typeof u=="number"&&this.state.record.length===u-1)return 0;e:for(let c=0;c<s.length;c++){let a=s[c];if(a[0]===o){for(let l=1;l<a.length;l++)if(a[l]!==n[i+l])continue e;return a.length}}return 0},__isRecordDelimiter:function(n,i,o){let{record_delimiter:s}=this.options,u=s.length;e:for(let c=0;c<u;c++){let a=s[c],l=a.length;if(a[0]===n){for(let f=1;f<l;f++)if(a[f]!==i[o+f])continue e;return a.length}}return 0},__isEscape:function(n,i,o){let{escape:s}=this.options;if(s===null)return!1;let u=s.length;if(s[0]===o){for(let c=0;c<u;c++)if(s[c]!==n[i+c])return!1;return!0}return!1},__isQuote:function(n,i){let{quote:o}=this.options;if(o===null)return!1;let s=o.length;for(let u=0;u<s;u++)if(o[u]!==n[i+u])return!1;return!0},__autoDiscoverRecordDelimiter:function(n,i){let{encoding:o}=this.options,s=[Buffer.from(`\r
`,o),Buffer.from(`
`,o),Buffer.from("\r",o)];e:for(let u=0;u<s.length;u++){let c=s[u].length;for(let a=0;a<c;a++)if(s[u][a]!==n[i+a])continue e;return this.options.record_delimiter.push(s[u]),this.state.recordDelimiterMaxLength=s[u].length,s[u].length}return 0},__error:function(n){let{encoding:i,raw:o,skip_records_with_error:s}=this.options,u=typeof n=="string"?new Error(n):n;if(s){this.state.recordHasError=!0,this.options.on_skip!==void 0&&this.options.on_skip(u,o?this.state.rawBuffer.toString(i):void 0);return}else return u},__infoDataSet:function(){return{...this.info,columns:this.options.columns}},__infoRecord:function(){let{columns:n,raw:i,encoding:o}=this.options;return{...this.__infoDataSet(),error:this.state.error,header:n===!0,index:this.state.record.length,raw:i?this.state.rawBuffer.toString(o):void 0}},__infoField:function(){let{columns:n}=this.options,i=Array.isArray(n);return{...this.__infoRecord(),column:i===!0?n.length>this.state.record.length?n[this.state.record.length].name:null:this.state.record.length,quoting:this.state.wasQuoting}}}};var Br=function(t,e={}){typeof t=="string"&&(t=Buffer.from(t));let r=e&&e.objname?{}:[],n=$r(e),i=c=>{n.options.objname===void 0?r.push(c):r[c[0]]=c[1]},o=()=>{},s=n.parse(t,!1,i,o);if(s!==void 0)throw s;let u=n.parse(void 0,!0,i,o);if(u!==void 0)throw u;return r};var Lr=J(require("fs")),Ur=J(require("os")),pe=J(require("path"));function kr(){return{files:Ct(x.getInput("files")),workdir:x.getInput("workdir")||".",targets:Ct(x.getInput("targets")),noCache:x.getBooleanInput("no-cache"),pull:x.getBooleanInput("pull"),load:x.getBooleanInput("load"),push:x.getBooleanInput("push"),set:Ct(x.getInput("set")),source:x.getInput("source"),project:x.getInput("project"),token:x.getInput("token")||process.env.DEPOT_TOKEN,buildxFallback:x.getBooleanInput("buildx-fallback")}}var Ee;function Ke(){return Ee||(x.getState("tempDir")?x.getState("tempDir"):(Ee=Lr.mkdtempSync(pe.join(Ur.tmpdir(),"depot-build-push-").split(pe.sep).join(pe.posix.sep)),x.saveState("tempDir",Ee),Ee))}var Pt=!!x.getState("isPost");Pt||x.saveState("isPost","true");function Ct(t){return t=t.trim(),t===""?[]:Br(t,{columns:!1,relaxColumnCount:!0,relaxQuotes:!0,skipEmptyLines:!0}).flatMap(r=>r).map(r=>r.trim()).filter(r=>r)}var ae=J(Se()),Ie=J(an()),cn=J(pt()),et=J(require("fs")),ye=J(require("path"));var Is=new cn.HttpClient("depot-build-push-action");async function fn(){try{let{exitCode:t}=await Ie.getExecOutput("depot",[],{ignoreReturnCode:!0,silent:!0});return t===0}catch{return!1}}async function dn(){await Ie.exec("depot",["version"],{failOnStdErr:!1})}async function ln(t,e,r){var i,o;let n=await Ie.getExecOutput(t,e,r);if(n.stderr.length>0&&n.exitCode!=0)throw new Error(`failed with: ${((o=(i=n.stderr.match(/(.*)\s*$/))==null?void 0:i[0])==null?void 0:o.trim())??"unknown error"}`)}async function hn(t){let e=t.targets.length>0?t.targets:["default"],r=[...H("--file",t.files),...H("--no-cache",t.noCache),...H("--pull",t.pull),...H("--load",t.load),...H("--push",t.push),...H("--set",t.set),...H("--push",t.push),...H("--set",t.set),...H("--metadata-file",_n())],n=[...H("--project",t.project)],i=[...r,...n,...e],o=t.token??process.env.DEPOT_TOKEN;if(!o)try{let s=await ae.getIDToken("https://depot.dev"),u=await Is.postJson("https://github.depot.dev/auth/oidc/github-actions",{token:s});u.result&&u.result.token&&(o=u.result.token,ae.info("Exchanged GitHub Actions OIDC token for temporary Depot token"))}catch(s){ae.info(`Unable to exchange GitHub OIDC token for temporary Depot token: ${s}`)}try{await ln("depot",["bake",...i],{cwd:t.workdir,ignoreReturnCode:!0,env:{...process.env,...o?{DEPOT_TOKEN:o}:{}}})}catch(s){if(t.buildxFallback)ae.warning(`falling back to buildx: ${s}`),await ln("docker",["buildx","bake",...r,...e],{ignoreReturnCode:!0});else throw s}}function H(t,e){return e?e===!0?[t]:Array.isArray(e)?e.flatMap(r=>[t,r]):[t,e]:[]}function _n(){return ye.join(Ke(),"metadata-file").split(ye.sep).join(ye.posix.sep)}function mn(){let t=_n();if(!et.existsSync(t))return;let e=et.readFileSync(t,{encoding:"utf-8"}).trim();if(e!=="null")return e}async function Ts(){if(!await fn())return A.setFailed("Depot CLI is not installed. See https://github.com/depot/setup-action to install it before this step.");await A.group("Depot version",async()=>{await dn()});let t=kr();await hn(t);let e=mn();e&&await A.group("Metadata",async()=>{A.info(e),A.setOutput("metadata",e)})}async function Ns(){let t=Ke();t.length!==0&&(A.startGroup(`Removing temp folder ${t}`),pn.rmSync(t,{recursive:!0}),A.endGroup())}(Pt?Ns():Ts()).catch(t=>{t instanceof Error?A.setFailed(t.message):A.setFailed(`${t}`)});
